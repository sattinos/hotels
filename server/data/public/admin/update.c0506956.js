!function(e,t,n,r,o){var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i="function"==typeof a.parcelRequire&&a.parcelRequire,l="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function s(n,r){if(!t[n]){if(!e[n]){var o="function"==typeof parcelRequire&&parcelRequire;if(!r&&o)return o(n,!0);if(i)return i(n,!0);if(l&&"string"==typeof n)return l(n);var a=new Error("Cannot find module '"+n+"'");throw a.code="MODULE_NOT_FOUND",a}c.resolve=function(t){return e[n][1][t]||t},c.cache={};var u=t[n]=new s.Module(n);e[n][0].call(u.exports,c,u,u.exports,this)}return t[n].exports;function c(e){return s(c.resolve(e))}}s.isParcelRequire=!0,s.Module=function(e){this.id=e,this.bundle=s,this.exports={}},s.modules=e,s.cache=t,s.parent=i,s.register=function(t,n){e[t]=[function(e,t){t.exports=n},{}]},a.parcelRequire=s;for(var u=0;u<n.length;u++)s(n[u])}({"5JTp5":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=y();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}n.default=e,t&&t.set(e,n);return n}(e("react")),o=e("../../model/reservationEntity"),a=e("../shared");e("./style.less");var i=e("react-router"),l=e("../../paths"),s=h(e("../../controller/lib/localization/localizer")),u=e("../../controller/network/entityFetcher"),c=h(e("../../controller/appController")),d=e("../lib/roundButton"),f=h(e("./reservationViewer")),p=e("../storage");function h(e){return e&&e.__esModule?e:{default:e}}function y(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return y=function(){return e},e}class v extends r.Component{static getDefaultState=()=>({entity:(0,o.getDefaultReservation)(),saveEnabled:!1,toMainTapped:!1,desiredChunks:[]});constructor(e){super(e),this.state=v.getDefaultState()}async componentDidMount(){const e=await u.EntityFetcher.fetch(c.default.reservationsFetcher,a.shared.entityID,a.shared.busyFunction);console.log("fetched:",e),e&&this.setState({entity:e})}render(){return this.state.toMainTapped?r.createElement(i.Redirect,{to:l.paths.vaReservation}):r.createElement("div",{className:"form center"},r.createElement(f.default,{title:s.default.text("reserve.update"),entity:this.state.entity,onNewEntityAvailable:this.onNewEntityAvailable}),r.createElement("div",null,r.createElement(d.RoundBtn,{text:s.default.text("common.save"),disabled:!this.state.saveEnabled,onClick:this.onSaveTapped}),r.createElement(d.RoundBtn,{text:s.default.text("common.back"),disabled:!1,onClick:()=>this.setState({toMainTapped:!0})})))}validate=()=>{const e=this.state.desiredChunks.length>0&&this.state.entity.channel.length>0;console.log("saveEnabled",this.state.entity),this.setState({saveEnabled:e})};onSaveTapped=async()=>{const e=p.storage.userProfile;console.log(e),e&&(a.shared.busyFunction(!0),console.log("onSaveTapped",this.state.entity),await c.default.flatTypeFetcher.modify(this.state.entity.id,this.state.entity.from,this.state.entity.to,this.state.desiredChunks,e.id,this.state.entity.channel,!0),a.shared.alertFunction(s.default.text("reserve.success")),a.shared.busyFunction(!1))};onNewEntityAvailable=async(e,t)=>{console.log("onNewEntityAvailable",e),this.setState({entity:e,desiredChunks:t},(()=>{this.validate()}))}}var b=v;n.default=b},{react:"28kAn","../../model/reservationEntity":"7v774","../shared":"5kDOz","./style.less":"1YhmO","react-router":"14NBf","../../paths":"2jsBl","../../controller/lib/localization/localizer":"2Lq0B","../../controller/network/entityFetcher":"1aKQt","../../controller/appController":"5m3ws","../lib/roundButton":"29Imb","./reservationViewer":"1X2l2","../storage":"3K0zI"}],"1YhmO":[function(){},{}]},{},[]);